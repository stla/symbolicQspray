---
title: "The 'symbolicQspray' package"
author: "St√©phane Laurent"
date: "`r Sys.Date()`"
output: github_document
---

***Symbolic multivariate polynomials.*** 

<!-- badges: start -->
[![R-CMD-check](https://github.com/stla/symbolicQspray/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/stla/symbolicQspray/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

___

A `symbolicQspray` object represents a multivariate polynomial whose 
coefficients are fractions of polynomials with rational coefficients. 
For example:

```{r, message=FALSE, collapse=TRUE}
library(symbolicQspray)
f <- function(a1, a2, X1, X2, X3) {
  (a1/(a2^2+1)) * X1^2*X2  +  (a2+1) * X3  +  a1/a2
}
# "exterior" variables, the ones occuring in the coefficients:
a1 <- qlone(1)
a2 <- qlone(2)
# "main" variables:
X1 <- Qlone(1)
X2 <- Qlone(2)
X3 <- Qlone(3)
# the 'symbolicQspray':
( Qspray <- f(a1, a2, X1, X2, X3) )
```

The fractions of polynomials such as the first coefficient `a1/(a2^2+1)` 
in the above example are 
[**ratioOfSprays**](https://github.com/stla/ratioOfQsprays) objects, 
and the numerator and the denominator of a `ratioOfQsprays` are 
[**qspray**](https://github.com/stla/qspray) objects.

Arithmetic on `symbolicQspray` objects is available:

```{r, message=FALSE, collapse=TRUE}
Qspray^2
Qspray - Qspray
(Qspray - 1)^2
Qspray^2 - 2*Qspray + 1
```


## Evaluating a `symbolicQspray`

Substituting the "exterior" variables (the variables occurring in the ratios of 
polynomials) yields another `symbolicQspray`:

```{r, message=FALSE, collapse=TRUE}
a <- c(2, "3/2")
( Q <- evalSymbolicQspray(Qspray, a = a) )
```

This is discutable actually: this polynomial has rational coefficients, so 
one could consider it is a `qspray`. But on the other hand, one can consider 
that the polynomial variables `X`, `Y` and `Z` have not changed and still 
represent some indeterminate `ratioOfQsprays` fractions. Comments ?..

Substituting the "main" variables yields a `ratioOfQsprays` object:

```{r, message=FALSE, collapse=TRUE}
X <- gmp::as.bigq(c(4, 3, "2/5"))
( ratioOfQsprays <- evalSymbolicQspray(Qspray, X = X) )
```

Actually we can more generally use some `ratioOfQsprays` objects for the 
values of `X`, since a `symbolicQspray` object is a polynomial with 
`ratioOfQsprays` coefficients. We will do that, just after checking the 
consistency:

```{r, message=FALSE, collapse=TRUE}
evalSymbolicQspray(Qspray, a = a, X = X)
evalSymbolicQspray(Q, X = X)
evalRatioOfQsprays(ratioOfQsprays, a)
f(gmp::as.bigq(a[1]), gmp::as.bigq(a[2]), X[1], X[2], X[3])
```

Now let's use some `ratioOfQsprays` objects for the values of `X`:

```{r, message=FALSE, collapse=TRUE}
X <- list(
  qlone(1)/(1+qlone(1)), qlone(2)/qlone(1)^2, (qlone(2) + qlone(3))/qlone(1)
)
evalSymbolicQspray(Qspray, a = a, X = X)
evalSymbolicQspray(Q, X = X)
```

This is consistent, but again, there's a discutable point here: are we allowed 
to use `qlone(3)` (that is, `a3`) in the values of `X`, since the coefficients 
of `Qspray` involve `a1` and `a2` only? Here we cannot know: only the context 
can tell us in which space the coefficients of `Qspray` are living.

Also note that evaluating the `ratioOfQsprays` object 
`evalSymbolicQspray(Qspray, X = X)` at `a` makes no sense...

Actually my motivation to do this package was inspired by the 
**Jack polynomials**. In the context of Jack polynomials, the variables 
`X`, `Y` and `Z` represent indeterminate *numbers*, and the coefficients 
are *numbers depending on a parameter* (the Jack parameter), and it turns out 
that they are fractions of polynomials of this parameter. So in this context, 
the answers to the above questions are clear: we don't have to replace the 
variables `X`, `Y` and `Z` with `rationalQsprays` objects.


## Querying a `symbolicQspray` 

The package provides some functions to perform elementary queries on a 
`symbolicQspray`:

```{r, collapse=TRUE}
numberOfVariables(Qspray)
numberOfTerms(Qspray)
getCoefficient(Qspray, c(2, 1))
getConstantTerm(Qspray)
isUnivariate(Qspray)
isConstant(Qspray)
```


## Showing a `symbolicQspray` 

You can change the way a `symbolicQspray` is printed by using 
`showSymbolicQsprayOption`:

```{r, collapse=TRUE}
showSymbolicQsprayOption(Qspray, "a") <- "x"
showSymbolicQsprayOption(Qspray, "showMonomial") <- 
  showMonomialXYZ(c("A", "B", "C"))
showSymbolicQsprayOption(Qspray, "quotientBar") <- " / "
Qspray
```

When this is possible, the result of an arithmetic operation between two 
`symbolicQspray` objects inherits the show options of the first operand:

```{r, collapse=TRUE}
( Q <- rSymbolicQspray() ) # a random symbolicQspray
Qspray + Q
```


## Application to Jack polynomials

The **symbolicQspray** package is used by the 
[**jack**](https://github.com/stla/jackR) package to compute the Jack 
polynomials. The Jack polynomials are exactly the polynomials 
represented by the `symbolicQspray` objects: their coefficients are fractions 
of polynomials by definition, of one variable: the Jack parameter.
